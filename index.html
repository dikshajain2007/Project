<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CampusShare</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#667eea,#764ba2);
    padding:20px;
    max-width:1200px;
    margin:auto;
}
header{
    background:white;
    padding:15px;
    border-radius:12px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:20px;
}
button{
    padding:8px 14px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:bold;
}
.green{background:#4CAF50;color:white;}
.blue{background:#2196F3;color:white;}
.orange{background:#FF9800;color:white;}
.purple{background:#9C27B0;color:white;}
.hidden{display:none;}

.grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
    gap:20px;
}
.card{
    background:white;
    padding:15px;
    border-radius:12px;
}
.card img{
    width:100%;
    height:180px;
    object-fit:cover;
    border-radius:10px;
}
.modal{
    position:fixed;
    top:0;left:0;
    width:100%;height:100%;
    background:rgba(0,0,0,0.6);
    display:none;
}
.modal-content{
    background:white;
    padding:20px;
    border-radius:12px;
    width:90%;
    max-width:400px;
    margin:8% auto;
}
input,textarea{
    width:100%;
    padding:10px;
    margin-bottom:10px;
}
.chat-box{
    height:220px;
    border:1px solid #ccc;
    padding:10px;
    overflow-y:auto;
    margin-bottom:10px;
    background:#f9f9f9;
}
.msg{
    margin-bottom:6px;
    font-size:14px;
}
.me{color:#4CAF50;}
.seller{color:#333;}
</style>
</head>

<body>

<header>
<h2>üè´ CampusShare</h2>
<div>
<button class="green" onclick="showLogin()">Login</button>
<button class="green hidden" id="logoutBtn" onclick="logout()">Logout</button>
<button class="blue" onclick="showListings()">Browse</button>
<button class="green hidden" id="addBtn" onclick="showAddForm()">List Item</button>
</div>
</header>

<!-- LOGIN -->
<div id="loginBox">
<div class="card" style="max-width:400px;margin:auto;">
<h3>Login</h3>
<input type="email" id="emailInput" placeholder="email@example.com">
<button class="green" onclick="login()">Login</button>
</div>
</div>

<!-- MAIN -->
<div id="mainBox" class="hidden">
<div id="listings" class="grid"></div>

<div id="addForm" class="hidden card" style="margin-top:20px;">
<h3>Add Item</h3>
<input id="name" placeholder="Item name">
<textarea id="desc" placeholder="Description"></textarea>
<input id="price" placeholder="Price or Free">
<input id="image" placeholder="Image URL">
<input id="phone" placeholder="Phone">
<input id="email" placeholder="Email">
<button class="green" onclick="addItem()">Add</button>
</div>
</div>

<!-- CONTACT MODAL -->
<div id="contactModal" class="modal">
<div class="modal-content">
<div id="contactText"></div>
<button class="blue" onclick="closeContact()">Close</button>
</div>
</div>

<!-- PORTER MODAL -->
<div id="porterModal" class="modal">
<div class="modal-content">
<h3>üöö Porter Request</h3>
<input placeholder="Pickup location">
<input placeholder="Drop location">
<input placeholder="Approx weight (kg)">
<button class="orange" onclick="confirmPorter()">Confirm</button>
<button class="blue" onclick="closePorter()">Cancel</button>
</div>
</div>

<!-- CHAT MODAL -->
<div id="chatModal" class="modal">
<div class="modal-content">
<h3 id="chatTitle">Chat</h3>
<div class="chat-box" id="chatBox"></div>
<input id="chatInput" placeholder="Type a message">
<button class="purple" onclick="sendMessage()">Send</button>
<button class="blue" onclick="closeChat()">Close</button>
</div>
</div>

<script>
let currentUser=null;
let selectedItem=null;
let chats={};

let items=[
{id:1,title:"Study Chair",desc:"Good condition",price:"‚Çπ800",image:"https://images.unsplash.com/photo-1550283420-33e325a3a639",donor:"Amit",contact:{phone:"9876543210",email:"amit@mail.com"},claimed:false},
{id:2,title:"Old Mattress",desc:"Clean and usable",price:"‚Çπ500",image:"https://images.unsplash.com/photo-1588880331179-46d541a819de",donor:"Neha",contact:{phone:"9123456789",email:"neha@mail.com"},claimed:false},
{id:3,title:"Table Fan",desc:"Working perfectly",price:"‚Çπ300",image:"https://images.unsplash.com/photo-1600585154340-be6161a56a0c",donor:"Rahul",contact:{phone:"9988776655",email:"rahul@mail.com"},claimed:false},
{id:4,title:"Single Bed Frame",desc:"Metal frame",price:"‚Çπ1200",image:"https://images.unsplash.com/photo-1505691938895-1758d7feb511",donor:"Kunal",contact:{phone:"9000011111",email:"kunal@mail.com"},claimed:false},
{id:5,title:"Bookshelf",desc:"4 shelves",price:"‚Çπ700",image:"https://images.unsplash.com/photo-1582582429416-56d59c2f34c4",donor:"Riya",contact:{phone:"9000022222",email:"riya@mail.com"},claimed:false}
];

function showLogin(){
document.getElementById("loginBox").classList.remove("hidden");
document.getElementById("mainBox").classList.add("hidden");
}

function login(){
const email=document.getElementById("emailInput").value;
if(!email.includes("@")){alert("Invalid email");return;}
currentUser={email};
document.getElementById("loginBox").classList.add("hidden");
document.getElementById("mainBox").classList.remove("hidden");
document.getElementById("logoutBtn").classList.remove("hidden");
document.getElementById("addBtn").classList.remove("hidden");
render();
}

function logout(){currentUser=null;showLogin();}
function showListings(){document.getElementById("addForm").classList.add("hidden");render();}
function showAddForm(){document.getElementById("addForm").classList.remove("hidden");}

function render(){
document.getElementById("listings").innerHTML=items.filter(i=>!i.claimed).map(i=>`
<div class="card">
<img src="${i.image}">
<h4>${i.title}</h4>
<p>${i.desc}</p>
<b>${i.price}</b>
<p>üìû ${i.contact.phone}</p>
<p>üìß ${i.contact.email}</p>
<button class="blue" onclick="contact(${i.id})">Contact</button>
<button class="purple" onclick="openChat(${i.id})">Chat</button>
<button class="orange" onclick="porter(${i.id})">Porter</button>
<button class="green" onclick="claim(${i.id})">Claim</button>
</div>`).join("");
}

function contact(id){
const i=items.find(x=>x.id===id);
document.getElementById("contactText").innerHTML=
`<b>${i.donor}</b><br>${i.contact.phone}<br>${i.contact.email}`;
document.getElementById("contactModal").style.display="block";
}
function closeContact(){document.getElementById("contactModal").style.display="none";}

function porter(id){selectedItem=id;document.getElementById("porterModal").style.display="block";}
function closePorter(){document.getElementById("porterModal").style.display="none";}
function confirmPorter(){alert("üöö Porter booked");closePorter();}

function claim(id){items.find(x=>x.id===id).claimed=true;render();}

function openChat(id){
selectedItem=id;
const item=items.find(i=>i.id===id);
document.getElementById("chatTitle").innerText="Chat with "+item.donor;
document.getElementById("chatModal").style.display="block";
if(!chats[id]) chats[id]=[];
renderChat();
}

function renderChat(){
const box=document.getElementById("chatBox");
box.innerHTML=chats[selectedItem].map(m=>
`<div class="msg ${m.by}"><b>${m.by}:</b> ${m.text}</div>`
).join("");
box.scrollTop=box.scrollHeight;
}

function sendMessage(){
const input=document.getElementById("chatInput");
if(!input.value.trim()) return;
chats[selectedItem].push({by:"me",text:input.value});
chats[selectedItem].push({by:"seller",text:"Okay, noted."});
input.value="";
renderChat();
}

function closeChat(){document.getElementById("chatModal").style.display="none";}

function addItem(){
items.unshift({
id:Date.now(),
title:name.value,
desc:desc.value,
price:price.value||"Free",
image:image.value,
donor:currentUser.email.split("@")[0],
contact:{phone:phone.value,email:email.value},
claimed:false
});
render();
}
</script>

</body>
</html>
